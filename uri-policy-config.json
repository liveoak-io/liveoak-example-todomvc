{ 
    "uriRules": [
        {
            "priority": 2,
            "uriPattern": "*",
            "requestType": "*",
            "allowedRoles": "'test-app/admin'"
        },
        {
            "priority": 1,
            "uriPattern": "/app/(.*)[.](html|css|js|png)",
            "requestType": "READ",
            "allowedUsers": "'*'"
        },
        {
            "priority": 1,
            "uriPattern": "/client/(.*)[.]js",
            "requestType": "READ",
            "allowedUsers": "'*'"
        },
        {
            "priority": 1,
            "uriPattern": "/storage*",
            "requestType": "READ",
            "queryParamsCondition": "resourceParams.value('q') != null && resourceParams.value('q').contains('\\\"user\\\":\\\"' + $securityContext.subject + '\\\"')",
            "allowedRoles": "'test-app/user'"
        },
        {
            "priority": 1,
            "uriPattern": "/storage*",
            "requestType": "CREATE",
            "queryParamsCondition": "$requestState.getProperty('user') ==  $securityContext.subject",
            "allowedRoles": "'test-app/user'"
        },
        {
            "priority": 1,
            "uriPattern": "/storage*",
            "requestType": "UPDATE",
            "queryParamsCondition": "$requestState.getProperty('user') !=  $securityContext.subject",
            "deniedUsers": "'*'"
        }
    ]
}
